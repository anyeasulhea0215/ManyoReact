<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" th:href="@{/assets/css/mypage.css}"/>
  <title>마이페이지</title>
<style>
  .h2hr {
  width: 1200px;
  margin-bottom: 50px;
  border: none;
  height: 2px;
  background-color: #4b4b4b;
  }
  .delete-account-text {
  margin-left: 50px;
  }
  .delete-account-content {
  margin-bottom: 30px;
  margin-left: 50px;
  }
  .delete {
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 20px;
  }
  .notice-box {
  background-color: #f9f9f9;
  font-size: 14px;
  color: #444;
  padding: 30px;
  }
  .reason {
  display: flex;
  flex-direction: column;
  gap: 30px;
  }
  .checkbox-group {
  display: flex;
  flex-wrap: wrap;
  gap: 10px 30px;
  font-size: 14px;
  }
  .reason-text textarea {
  width: 100%;
  padding: 20px;
  resize: none;
  border: 1px solid #ddd;
  border-radius: 4px;
  }
  .agree {
  font-size: 14px;
  }
  .btn-group {
  margin-top: 20px;
  text-align: center;
  }
  .cancel-btn {
  padding: 10px 20px;
  background-color: #fff;
  color: #b20000;
  border: 1px solid #b20000;
  border-radius: 4px;
  font-weight: bold;
  cursor: pointer;
  }
  .cancel-btn:hover {
  background-color: #f9f9f9;
  }
  .withdraw-btn {
  padding: 10px 20px;
  background-color: #b20000;
  color: #fff;
  border: none;
  border-radius: 4px;
  font-weight: bold;
  cursor: pointer;
  }
  .withdraw-btn:hover {
  background-color: #8c0000;
  }
  </style>
</head>
<body>

<header th:replace="fragments/header :: my-header"></header>

<main>
  <aside>
    <h2>마이페이지</h2>

    <h3>쇼핑정보</h3>
    <ul>
      <li><a th:href="@{/mypage/orders}">주문목록/배송조회</a></li>
      <li><a th:href="@{/mypage/returns}">취소/반품/교환 내역</a></li>
      <li><a th:href="@{/mypage/refund}">환불/입금 내역</a></li>
      <li><a th:href="@{/mypage/wishlist}">위시리스트</a></li>
    </ul>

    <hr/>

    <h3>고객센터</h3>
    <ul>
      <li><a th:href="@{/mypage/inquiry}">1:1 문의</a></li>
    </ul>

    <hr/>

    <h3>회원정보</h3>
    <ul>
      <li><a th:href="@{/mypage/profile}">회원정보 변경</a></li>
      <li><a th:href="@{/mypage/withdraw}">회원 탈퇴</a></li>
    </ul>

    <hr/>

    <h3>나의 상품문의</h3>
    <ul>
      <li><a th:href="@{/mypage/product-inquiries}">나의 상품문의</a></li>
    </ul>

    <hr/>

    <h3>나의 상품후기</h3>
    <ul>
      <li><a th:href="@{/reviews/mine}">나의 상품후기</a></li>
    </ul>
  </aside>

  <div class="delete-account">
    <div class="delete-account-text">
      <h2>회원탈퇴</h2>
      <p>회원탈퇴를 신청하시기 전 확인해주세요.</p>
      <hr class="h2hr">
    </div>

    <!-- 01. 회원탈퇴 안내 -->
    <div class="delete-account-content">
      <p class="delete">01. 회원탈퇴 안내</p>
      <div class="notice-box">
        <p>
          탈퇴 후 30일 동안 재가입이 제한됩니다.<br>
          탈퇴 신청 시 가지고 계신 회원혜택은 모두 사라지며, 재가입 시 복원되지 않습니다.<br>
          개인정보보호정책에 따라 유효기간 보관 후 파기 또는 즉시 파기 됩니다.
        </p>
      </div>
    </div>

    <!-- 02. 회원탈퇴 하기 -->
    <div class="delete-account-content">
      <p class="delete">02. 회원탈퇴 하기</p>
      <form th:action="@{/mypage/submit}" method="post">
        <div class="reason">
          <div class="checkbox-group">
            <label><input type="checkbox" name="reason" value="고객서비스 불만"> 고객서비스(상담, 포장 등) 불만</label>
            <label><input type="checkbox" name="reason" value="배송불만"> 배송불만</label>
            <label><input type="checkbox" name="reason" value="교환/환불/반품 불만"> 교환/환불/반품 불만</label>
            <label><input type="checkbox" name="reason" value="방문 빈도 낮음"> 방문 빈도가 낮음</label>
            <label><input type="checkbox" name="reason" value="상품가격 불만"> 상품가격 불만</label>
            <label><input type="checkbox" name="reason" value="개인 정보 유출 우려"> 개인정보 유출 우려</label>
            <label><input type="checkbox" name="reason" value="쇼핑몰의 신뢰도 불만"> 쇼핑몰의 신뢰도 불만</label>
          </div>

          <div class="reason-text">
            <p class="delete">03. 탈퇴 사유</p>
            <textarea name="customReason" rows="5" placeholder="탈퇴 사유를 입력해주세요.&#10;앞으로 보다 좋은 서비스로 찾아뵙겠습니다."></textarea>
          </div>

          <div class="agree">
            <label><input type="checkbox" name="agree" required> 위 안내사항을 모두 확인하였으며, 이에 동의합니다.</label>
          </div>

          <div class="btn-group">
            <button type="button" class="cancel-btn" onclick="history.back()">이전으로</button>
            <button type="button" class="withdraw-btn" onclick="submitWithdrawal()">탈퇴하기</button>
          </div>
        </div>
      </form>
    </div>
  </div>
</main>

<div th:replace="~{fragments/footer :: my-footer}"></div>
<script th:src="@{/assets/js/logout.js}"></script>

<script>
  function submitWithdrawal() {

    const checkboxes=document.querySelectorAll('input[name="reason"]:checked');
    const isAgreed=document.querySelector('input[name="agree"]:checked');


    if(checkboxes.length == 0){
        alert("탈퇴 사유를 한가지 이상 선택해주세요");
        return;
    }

    if(!isAgreed){
        alert("안내 사항에 동의하셔야 탈퇴할수 있습니다");
        return;
    }

    location.href="/login/out";

  }
</script>

</body>
</html>
